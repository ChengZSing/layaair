var FilterAction=function(){function t(){this.data=null}__class(t,"laya.filters.FilterAction",!0);var e=t.prototype;return Laya.imps(e,{"laya.filters.IFilterAction":!0}),e.apply=function(t){return null},t}(),WebGLFilter=function(){function t(){}return __class(t,"laya.filters.WebGLFilter",!0),t.enable=function(){t.isInit||(t.isInit=!0,Render.isWebGL&&(RunDriver.createFilterAction=function(t){var e;switch(t){case 32:e=new ColorFilterActionGL;break;case 16:e=new BlurFilterActionGL;break;case 8:e=new GlowFilterActionGL}return e}))},t.isInit=!1,t.__init$=function(){ColorFilterActionGL,Render,RunDriver,RunDriver.createFilterAction=function(t){var e;switch(t){case 16:case 8:e=new FilterAction;break;case 32:e=new ColorFilterAction}return e}},t}(),BlurFilter=function(t){function e(t){this.strength=NaN,this.strength_sig2_2sig2_gauss1=[],e.__super.call(this),void 0===t&&(t=4),Render.isWebGL&&WebGLFilter.enable(),this.strength=t,this._action=RunDriver.createFilterAction(16),this._action.data=this}__class(e,"laya.filters.BlurFilter",!1,t);var i=e.prototype;return i.callNative=function(t){t.conchModel&&t.conchModel.blurFilter&&t.conchModel.blurFilter(this.strength)},__getset(0,i,"type",function(){return 16}),__getset(0,i,"action",function(){return this._action}),e}(Filter),GlowFilter=function(t){function n(t,e,i,r){this._color=null,n.__super.call(this),this._elements=new Float32Array(9),void 0===e&&(e=4),void 0===i&&(i=6),void 0===r&&(r=6),Render.isWebGL&&WebGLFilter.enable(),this._color=new Color(t),this.blur=Math.min(e,20),this.offX=i,this.offY=r,this._action=RunDriver.createFilterAction(8),this._action.data=this}__class(n,"laya.filters.GlowFilter",!1,t);var e=n.prototype;return e.getColor=function(){return this._color._color},e.callNative=function(t){t.conchModel&&t.conchModel.glowFilter&&t.conchModel.glowFilter(this._color.strColor,this._elements[4],this._elements[5],this._elements[6])},__getset(0,e,"blur",function(){return this._elements[4]},function(t){this._elements[4]=t}),__getset(0,e,"offY",function(){return this._elements[6]},function(t){this._elements[6]=t}),__getset(0,e,"offX",function(){return this._elements[5]},function(t){this._elements[5]=t}),__getset(0,e,"action",function(){return this._action}),__getset(0,e,"type",function(){return 8}),n}(Filter),GlowFilterActionGL=function(t){function e(){this.data=null,this._initKey=!1,this._textureWidth=0,this._textureHeight=0,e.__super.call(this)}__class(e,"laya.filters.webgl.GlowFilterActionGL",!1,t);var i=e.prototype;return Laya.imps(i,{"laya.filters.IFilterActionGL":!0}),i.setValueMix=function(t){},i.apply3d=function(t,e,i,r,n){var s=t.getValue("bounds");t.addValue("color",this.data.getColor());var a,l=s.width,o=s.height;this._textureWidth=l,this._textureHeight=o;var u=Matrix.TEMP;return u.identity(),(a=Value2D.create(1,0)).setFilters([this.data]),i.ctx.drawTarget(t,0,0,this._textureWidth,this._textureHeight,u,"src",a,null),a=Value2D.create(1,0),i.ctx.drawTarget(t,0,0,this._textureWidth,this._textureHeight,u,"src",a),null},i.setSpriteWH=function(t){this._textureWidth=t.width,this._textureHeight=t.height},i.setValue=function(t){t.u_offsetX=this.data.offX,t.u_offsetY=-this.data.offY,t.u_strength=1,t.u_blurX=this.data.blur,t.u_blurY=this.data.blur,t.u_textW=this._textureWidth,t.u_textH=this._textureHeight,t.u_color=this.data.getColor()},__getset(0,i,"typeMix",function(){return 8}),e.tmpTarget=function(t,e,i,r,n){var s=t.getValue("bounds");t.getValue("out").end();var a=RenderTarget2D.create(s.width,s.height);a.start();var l=t.getValue("color");l&&a.clear(l[0],l[1],l[2],0),t.addValue("tmpTarget",a)},e.startOut=function(t,e,i,r,n){t.getValue("tmpTarget").end();var s=t.getValue("out");s.start();var a=t.getValue("color");a&&s.clear(a[0],a[1],a[2],0)},e.recycleTarget=function(t,e,i,r,n){t.getValue("src");t.getValue("tmpTarget").recycle()},e}(FilterActionGL),BlurFilterActionGL=function(t){function e(){this.data=null,e.__super.call(this)}__class(e,"laya.filters.webgl.BlurFilterActionGL",!1,t);var i=e.prototype;return i.setValueMix=function(t){t.defines.add(this.data.type)},i.apply3d=function(t,e,i,r,n){var s=t.getValue("bounds"),a=Value2D.create(1,0);a.setFilters([this.data]),Matrix.EMPTY.identity(),i.ctx.drawTarget(t,0,0,s.width,s.height,Matrix.EMPTY,"src",a),a.setFilters(null)},i.setValue=function(t){t.strength=this.data.strength;var e=this.data.strength/3,i=e*e;this.data.strength_sig2_2sig2_gauss1[0]=this.data.strength,this.data.strength_sig2_2sig2_gauss1[1]=i,this.data.strength_sig2_2sig2_gauss1[2]=2*i,this.data.strength_sig2_2sig2_gauss1[3]=1/(2*Math.PI*i),t.strength_sig2_2sig2_gauss1=this.data.strength_sig2_2sig2_gauss1},__getset(0,i,"typeMix",function(){return 16}),e}(FilterActionGL);Laya.__init([WebGLFilter]),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(t,e){"use strict";for(var i in Object.defineProperty(e,"__esModule",{value:!0}),Laya){var r=Laya[i];r&&r.__isclass&&(e[i]=r)}});